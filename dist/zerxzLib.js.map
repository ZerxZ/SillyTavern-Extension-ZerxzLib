{"version":3,"file":"zerxzLib.js","mappings":"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","sources":["webpack://extension-zerxz-lib/webpack/bootstrap","webpack://extension-zerxz-lib/webpack/runtime/define property getters","webpack://extension-zerxz-lib/webpack/runtime/hasOwnProperty shorthand","webpack://extension-zerxz-lib/external module \"../../../../../script.js\"","webpack://extension-zerxz-lib/external module \"../../../../../scripts/extensions.js\"","webpack://extension-zerxz-lib/external module \"../../../../../scripts/secrets.js\"","webpack://extension-zerxz-lib/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"callPopup\"]: () => (__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.callPopup), [\"eventSource\"]: () => (__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.eventSource), [\"event_types\"]: () => (__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.event_types), [\"getRequestHeaders\"]: () => (__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.getRequestHeaders), [\"saveSettingsDebounced\"]: () => (__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.saveSettingsDebounced) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"extension_settings\"]: () => (__WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__.extension_settings) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"updateSecretDisplay\"]: () => (__WEBPACK_EXTERNAL_MODULE__scripts_secrets_js_e26d24e7__.updateSecretDisplay), [\"writeSecret\"]: () => (__WEBPACK_EXTERNAL_MODULE__scripts_secrets_js_e26d24e7__.writeSecret) });","import {\n\teventSource,\n\tevent_types,\n\tsaveSettingsDebounced,\n\tgetRequestHeaders,\n\tcallPopup,\n} from \"@silly-tavern/script\";\nimport {\n\textension_settings,\n\tgetContext,\n\tloadExtensionSetting,\n} from \"@silly-tavern/scripts/extensions\";\nimport {\n\tsecret_state,\n\tupdateSecretDisplay,\n\twriteSecret,\n} from \"@silly-tavern/scripts/secrets\";\nimport { oai_settings } from \"@silly-tavern/scripts/openai\";\nconst extensionName = \"SillyTavern-Extension-ZerxzLib\";\nconst extensionFolderPath = `scripts/extensions/third-party/${extensionName}`;\nconst extensionSettings = extension_settings[extensionName];\nconst defaultSettings = {};\ninterface Model {\n\tname: string;\n\tmodel: string;\n}\nexport default async function init(secrets: Record<string, string>) {\n\tif (!secrets) {\n\t\treturn;\n\t}\n\tconst modelStr = JSON.parse(secrets.models_makersuite ?? \"[]\") as Model[];\n\tconst api_key = secrets.api_key_makersuite ?? \"\";\n\tconsole.log(\"ZerxzLib init\");\n\tconst optgroup = $(\"#model_google_select > optgroup\");\n\tconsole.log(\"optgroup\", optgroup);\n\tconst primaryVersions = optgroup[0];\n\tconst subVersions = optgroup[1];\n\tconsole.log(\"subVersions\", subVersions);\n\tconst subVersionsArray = Array.from(\n\t\tsubVersions.children,\n\t) as HTMLOptionElement[];\n\tconst primaryVersionsArray = Array.from(\n\t\tprimaryVersions.children,\n\t) as HTMLOptionElement[];\n\tconsole.log(\"subVersionsArray\", subVersionsArray);\n\tconst subVersionsValues = subVersionsArray.map((el) => el.value);\n\tconst primaryVersionsValues = primaryVersionsArray.map((el) => el.value);\n\tconst mergedVersions = [\n\t\t...primaryVersionsValues,\n\t\t...subVersionsValues,\n\t\t...modelStr.map((model) => model.model),\n\t];\n\tif (modelStr.length > 0) {\n\t\tfor (const model of modelStr) {\n\t\t\tconst option = document.createElement(\"option\");\n\t\t\toption.value = model.model;\n\t\t\toption.text = model.name;\n\t\t\tsubVersions.appendChild(option);\n\t\t}\n\t}\n\tconsole.log(\"subVersionsValues\", subVersionsValues);\n\n\tconst geminiModels = await getGeminiModel(api_key);\n\tconsole.log(\"geminiModels\", geminiModels);\n\tconst geminiModelOptions = geminiModels.filter(\n\t\t(model) => !mergedVersions.includes(model.model),\n\t);\n\tif (geminiModelOptions.length === 0) {\n\t\treturn;\n\t}\n\n\tconsole.log(\"geminiModelOptions\", geminiModelOptions);\n\tfor (const model of geminiModelOptions) {\n\t\tconst option = document.createElement(\"option\");\n\t\toption.value = model.model;\n\t\toption.text = model.name;\n\t\tsubVersions.appendChild(option);\n\t}\n\twriteSecret(\"models_makersuite\", JSON.stringify(geminiModelOptions));\n\t// 更新密钥显示\n\tupdateSecretDisplay();\n\t// 保存设置\n\tsaveSettingsDebounced();\n}\ninterface GeminiModel {\n\tdescription: string;\n\tdisplayName: string;\n\tinputTokenLimit: number;\n\tmaxTemperature: number;\n\tname: string;\n\toutputTokenLimit: number;\n\tsupportedGenerationMethods: string[];\n\ttemperature: number;\n\ttopK: number;\n\ttopP: number;\n\tversion: string;\n}\ninterface GeminiResponse {\n\tmodels: GeminiModel[];\n}\n\nasync function getGeminiModel(key: string) {\n\ttry {\n\t\tconst result = await fetch(\n\t\t\t`https://generativelanguage.googleapis.com/v1beta/models/?key=${key}`,\n\t\t);\n\t\tconst data = (await result.json()) as GeminiResponse;\n\t\tconsole.log(data);\n\t\treturn data.models\n\t\t\t.filter((model) => model.name.includes(\"gemini\"))\n\t\t\t.map((modelData) => {\n\t\t\t\tconst model = modelData.name.replace(\"models/\", \"\");\n\t\t\t\tconst name = modelData.displayName;\n\n\t\t\t\treturn {\n\t\t\t\t\tname,\n\t\t\t\t\tmodel,\n\t\t\t\t};\n\t\t\t});\n\t} catch (e) {\n\t\tconsole.error(e);\n\t\treturn [];\n\t}\n}\nconst key = \"api_key_makersuite_custom\";\nasync function getSecrets() {\n\tconst response = await fetch(\"/api/secrets/view\", {\n\t\tmethod: \"POST\",\n\t\theaders: getRequestHeaders(),\n\t});\n\n\tif (response.status === 403) {\n\t\tcallPopup(\n\t\t\t\"<h3>禁止访问</h3><p>要在此处查看您的 API 密钥，请在 config.yaml 文件中将 allowKeysExposure 的值设置为 true，然后重新启动 SillyTavern 服务器。</p>\",\n\t\t\t\"text\",\n\t\t);\n\t\treturn;\n\t}\n\n\tif (!response.ok) {\n\t\treturn;\n\t}\n\n\t// $(\"#dialogue_popup\").addClass(\"wide_dialogue_popup\");\n\tconst data = (await response.json()) as Record<string, string>;\n\tconsole.log(\"data\", data);\n\treturn data;\n}\nasync function createButton(title: string, onClick: () => void) {\n\tconst div = document.createElement(\"div\");\n\tdiv.classList.add(\"menu_button\", \"menu_button_icon\", \"interactable\");\n\tdiv.title = title;\n\tdiv.onclick = onClick;\n\tconst span = document.createElement(\"span\");\n\tspan.textContent = title;\n\tdiv.appendChild(span);\n\treturn div;\n}\nasync function switchSecretsFromArray(generationType, _args, isDryRun) {\n\tconst secrets = await getSecrets();\n\tif (!secrets) {\n\t\treturn;\n\t}\n\n\tconst api_key = secrets[key] ?? \"\";\n\tconst api_keys = api_key\n\t\t.split(/[\\n;]/)\n\t\t.map((v) => v.trim())\n\t\t.filter((v) => v.length > 0 && v.startsWith(\"AIzaSy\"));\n\tif (api_keys.length === 0) {\n\t\treturn;\n\t}\n\tconst currentKey = secrets.api_key_makersuite;\n\tlet firstKeyApi = \"\";\n\tif (api_keys.includes(currentKey)) {\n\t\tapi_keys.splice(api_keys.indexOf(currentKey), 1);\n\t\tapi_keys.push(currentKey);\n\t\tfirstKeyApi = api_keys[0];\n\t\twriteSecret(\"api_key_makersuite\", firstKeyApi);\n\t\tsaveKey(key, api_keys.join(\"\\n\"));\n\t}\n\tconst textarea = $(\"#api_key_makersuite_custom\")[0] as HTMLTextAreaElement;\n\n\tconst currentKeyElement = $(\"#current_key_maker_suite\")[0] as HTMLSpanElement;\n\tconst lastKeyElement = $(\"#last_key_maker_suite\")[0] as HTMLSpanElement;\n\tconsole.log(\"textarea\", textarea);\n\tconsole.log(\"api_keys\", api_keys);\n\tif (!textarea) {\n\t\treturn;\n\t}\n\tcurrentKeyElement.textContent = `当前密钥: ${firstKeyApi}`;\n\tlastKeyElement.textContent = `最后一个密钥: ${currentKey}`;\n\n\ttextarea.value = api_keys.join(\"\\n\");\n}\nasync function saveKey(key: string, value: string) {\n\t// 设置密钥\n\twriteSecret(key, value);\n\t// 更新密钥显示\n\tupdateSecretDisplay();\n\t// 保存设置\n\tsaveSettingsDebounced();\n}\njQuery(async () => {\n\t// // 添加div元素\n\t// const div = document.createElement(\"div\");\n\t// // 添加class 为\"menu_button menu_button_icon interactable\"的类\n\t// div.classList.add(\"menu_button\", \"menu_button_icon\", \"interactable\");\n\t// // 添加title属性 获取新的模型\n\t// div.title = \"获取新的模型\";\n\t// // 添加点击事件\n\t// div.onclick = async () => {\n\t// \t// 获取模型\n\t// \tawait init();\n\t// };\n\t// // 添加span元素 内容为\"获取新的模型\"\n\t// const span = document.createElement(\"span\");\n\t// span.textContent = \"获取新的模型\";\n\t// div.appendChild(span);\n\n\t// 获取form元素 id为\"makersuite_form\"的元素 用jquery的选择器\n\tconst secrets = (await getSecrets()) ?? {};\n\tawait init(secrets);\n\tconst form = $(\"#makersuite_form\")[0];\n\t// 创建div元素添加类为\"flex-container flex\"的类\n\tconst flexContainer = document.createElement(\"div\");\n\tflexContainer.classList.add(\"flex-container\", \"flex\");\n\t// 添加h4元素 内容为\"Google AI Studio API 多个密钥\"\n\tconst h4 = document.createElement(\"h4\");\n\th4.textContent = \"Google AI Studio API 多个密钥\";\n\tflexContainer.appendChild(h4);\n\t// 创建textare元素添加类为\"text_pole textarea_compact autoSetHeight\"的类\n\tconst textarea = document.createElement(\"textarea\");\n\ttextarea.classList.add(\"text_pole\", \"textarea_compact\", \"autoSetHeight\");\n\t// 设置placeholder属性\n\ttextarea.placeholder = \"API密钥\";\n\t// 设置高度\n\ttextarea.style.height = \"100px\";\n\t// 添加id属性\n\ttextarea.id = \"api_key_makersuite_custom\";\n\t// 监听input事件\n\ttextarea.addEventListener(\"change\", () => {\n\t\tconst value = textarea.value\n\t\t\t.split(/[\\n;]/)\n\t\t\t.map((v) => v.trim())\n\t\t\t.filter((v) => v.length > 0 && v.startsWith(\"AIzaSy\"));\n\n\t\ttextarea.value = value.join(\"\\n\");\n\t\tif (value.length === 0) {\n\t\t\tsaveKey(key, value.join(\"\\n\"));\n\t\t\treturn;\n\t\t}\n\t\tconst fistValue = value[0];\n\t\twriteSecret(\"api_key_makersuite\", fistValue);\n\t\tsaveKey(key, value.join(\"\\n\"));\n\t});\n\ttextarea.value = secrets[key] || \"\";\n\tflexContainer.appendChild(textarea);\n\t// 创建div元素添加类为\"flex-container flex\"的类\n\tconst flexContainer2 = document.createElement(\"div\");\n\t// 添加h4元素 内容为\"当前和最后一个密钥\"\n\tconst h42 = document.createElement(\"h4\");\n\th42.textContent = \"密钥调用信息:\";\n\tflexContainer2.appendChild(h42);\n\t// 创建span元素\n\tconst span = document.createElement(\"div\");\n\t// 设置内容\n\tspan.textContent = `当前: ${secrets.api_key_makersuite}`;\n\t// 添加id属性 `current_key_maker_suite`\n\tspan.id = \"current_key_maker_suite\";\n\t// 创建span元素\n\tconst span2 = document.createElement(\"div\");\n\t// 设置内容\n\tspan2.textContent = `最后: ${secrets[key]?.split(\"\\n\").pop()}`;\n\t// 添加id属性 `last_key_maker_suite`\n\tspan2.id = \"last_key_maker_suite\";\n\n\tflexContainer2.appendChild(span);\n\tflexContainer2.appendChild(span2);\n\tform.appendChild(flexContainer2);\n\tform.appendChild(flexContainer);\n\tconst modelButton = await createButton(\"获取新的模型\", async () => {\n\t\tconst secrets = (await getSecrets()) ?? {};\n\t\tawait init(secrets);\n\t});\n\tconst saveButton = await createButton(\"保存密钥\", async () => {\n\t\tconst value = textarea.value\n\t\t\t.split(/[\\n;]/)\n\t\t\t.map((v) => v.trim())\n\t\t\t.filter((v) => v.length > 0 && v.startsWith(\"AIzaSy\"));\n\n\t\ttextarea.value = value.join(\"\\n\");\n\t\tif (value.length === 0) {\n\t\t\tsaveKey(key, value.join(\"\\n\"));\n\t\t\treturn;\n\t\t}\n\t\tconst fistValue = value[0];\n\t\twriteSecret(\"api_key_makersuite\", fistValue);\n\t\tsaveKey(key, value.join(\"\\n\"));\n\t});\n\tconst div = document.createElement(\"div\");\n\tdiv.classList.add(\"flex-container\", \"flex\");\n\tdiv.appendChild(saveButton);\n\tdiv.appendChild(modelButton);\n\tform.appendChild(div);\n\t// 添加分割线\n\tform.appendChild(document.createElement(\"hr\"));\n\n\teventSource.on(\n\t\tevent_types.CHAT_COMPLETION_SETTINGS_READY,\n\t\tswitchSecretsFromArray,\n\t);\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","x","d","__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__","__WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__","__WEBPACK_EXTERNAL_MODULE__scripts_secrets_js_e26d24e7__","extensionName","extension_settings","async","init","secrets","modelStr","JSON","parse","models_makersuite","api_key","api_key_makersuite","console","log","optgroup","$","primaryVersions","subVersions","subVersionsArray","Array","from","children","primaryVersionsArray","subVersionsValues","map","el","value","mergedVersions","model","length","option","document","createElement","text","name","appendChild","geminiModels","result","fetch","data","json","models","filter","includes","modelData","replace","displayName","e","error","getGeminiModel","geminiModelOptions","writeSecret","stringify","updateSecretDisplay","saveSettingsDebounced","getSecrets","response","method","headers","getRequestHeaders","status","callPopup","ok","createButton","title","onClick","div","classList","add","onclick","span","textContent","switchSecretsFromArray","generationType","_args","isDryRun","api_keys","split","v","trim","startsWith","currentKey","firstKeyApi","splice","indexOf","push","saveKey","join","textarea","currentKeyElement","lastKeyElement","jQuery","form","flexContainer","h4","placeholder","style","height","id","addEventListener","fistValue","flexContainer2","h42","span2","pop","modelButton","saveButton","eventSource","on","event_types","CHAT_COMPLETION_SETTINGS_READY"],"sourceRoot":""}